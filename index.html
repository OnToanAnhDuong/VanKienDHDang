<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ôn luyện Toán</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="loginContainer">
        <h2>Đăng nhập</h2>
        <input type="text" id="studentId" placeholder="Nhập mã học sinh">
        <button id="loginBtn">Đăng nhập</button>
    </div>

    <div id="mainContent" style="display: none;">
        <h2>Danh sách bài tập</h2>
        <div id="exerciseGrid"></div>

        <div class="controls">
            <input type="number" id="problemIndexInput" placeholder="Nhập số bài">
            <button id="selectProblemBtn">Hiển thị bài tập</button>
            <button id="randomProblemBtn">Lấy bài tập ngẫu nhiên</button>
            <div>
                Số bài: <span id="completedExercises">0</span> |
                Tổng điểm: <span id="totalScore">0</span>
            </div>
        </div>

        <div id="problemContainer">
            <h2>Đề bài</h2>
            <div id="problemText"></div>
        </div>

        <div class="file-upload">
            <label for="studentImage">Chọn ảnh bài làm:</label>
            <input type="file" id="studentImage" accept="image/*">
            <button id="submitBtn">Chấm bài</button>
            <button id="deleteAllBtn">Xóa nội dung</button>
        </div>

        <div id="result"></div>

        <div id="cameraContainer">
            <h2>Chụp ảnh bài làm</h2>
            <video id="cameraStream" autoplay playsinline></video>
            <button id="captureButton">Chụp ảnh</button>
        </div>
    </div>

    <script>
        document.getElementById('loginBtn').addEventListener('click', async () => {
            const studentId = document.getElementById('studentId').value.trim();

            if (!studentId) {
                alert('Vui lòng nhập mã học sinh.');
                return;
            }

            try {
                const isValidStudent = await checkStudentId(studentId);
                if (isValidStudent) {
                    currentStudentId = studentId;
                    document.getElementById('loginContainer').style.display = 'none';
                    document.getElementById('mainContent').style.display = 'block';

                    await fetchProblems();
                    renderExerciseList();
                } else {
                    alert('Mã học sinh không hợp lệ. Vui lòng thử lại.');
                }
            } catch (error) {
                console.error('Lỗi khi đăng nhập:', error);
                alert('Đã xảy ra lỗi khi đăng nhập. Vui lòng thử lại sau.');
            }
        });

        async function checkStudentId(studentId) {
            const validIds = ['12345', '67890']; // Thay bằng danh sách mã hợp lệ thật
            return validIds.includes(studentId);
        }

        async function fetchProblems() {
            // Logic tải bài tập từ Google Sheet hoặc nguồn dữ liệu khác
            console.log('Fetching problems...');
        }

        function renderExerciseList() {
            // Logic hiển thị danh sách bài tập
            console.log('Rendering exercise list...');
        }
    </script>
    <script src="app.js" defer></script>
</body>
</html>
